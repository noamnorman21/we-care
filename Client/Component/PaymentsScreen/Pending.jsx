
import React, { useState, useEffect, useRef } from 'react';
import { View, Text, StyleSheet, TouchableOpacity, Alert, Dimensions, Animated, Modal, ScrollView } from 'react-native';
import { useIsFocused } from '@react-navigation/native';
import { List } from 'react-native-paper';
import { Feather } from '@expo/vector-icons';
import NewPayment from './NewPayment';
import EditPaymentScreen from './EditPaymentScreen';
import { useUserContext } from '../../UserContext';
import { AddBtn } from '../HelpComponents/AddNewTask';


export default function Pending({ route }) {
  const {userContext, userPendingPayments} = useUserContext()
  const [modal1Visible, setModal1Visible] = useState(false);
  const [Pendings, setPendings] = useState()
  const [List, setList] = useState([])
  const isFocused = useIsFocused()

  useEffect(() => {
    if (isFocused || !modal1Visible) {
      getPending()
    }
  }, [isFocused])

  


  const getPending = async () => {   
    try {
      const user={
        Id: userContext.Id,
        userType: userContext.userType
      }
      const response = await fetch('https://proj.ruppin.ac.il/cgroup94/test1/api/Payments/GetHistory/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(user)
      });
      // const data = await response.json();
      const data= [
        {
            "requestId": 190,
            "requestSubject": "Marketing",
            "amountToPay": 294.26823828568132,
            "requestDate": "2022-09-19T00:00:00",
            "requestProofDocument": "3ZSGXVNN82OCUDHHLFVV8YBGJHTS6WB5RT5VWQ0PV3OK983YAR3HIQ05OBXG1VHCQJK08LKUE6049R7ADVIESTM0T07KTKN0MBTPN3QO683CQWVW4M26C2JWXK77D00UIZIXXHNA4T7JQAAW4AF7HHNJRXS3WIA688TQEXZMYS1JV05M9A32KTD0CY60PJDMI1BIHJI7BT8OG4ORR6TLF8LEVTDFRZXFEE0TON4PSWRRKOJ89E8IQS7AFWNO52FCVTA23U3413TIHUU6956DQFOM7PERZGKPGEWREH4FB4HMYOTK2GE0W2MG4NUDGB4KJ322Y2SS0Q1LX2NJWTPI2JTESFMQMQYZ0W2VLQMZOMZ500I20BHMLLHZ9NAIF15AS1L1ZSX57PUGKODRXKQB9CEEE3LYG4JNHPDYEH28EBFVR1FL9IKUBT0FN6MW6ZP366ZVAFCGIIXYXINCNZOXJOBNOXA8U61ELBPK2KAU54CTW2I5I986ASKHUB6D44LCGICLS3A3PTRECIQMF5PLXU4TR8PQDXP1I0CEQWDFZ5HH154CLKXZF0FLEJTJDJPR3QVC6CVJS9LRCMRM3D5T0QLIKQ072T1GFQDB9S69OD76EN9RR7F0EVQD4DRFCOGY75CM9GCB7W5MIF4XH8GUD02JZZ6W1QXZX8Y8BMIAV4THQ4UP9TX38LL73SM9AF9GY5PAHVMVQ5Z87KTV5HN7TTQBNR5JZ80GUDJKFK8D72D2MCZJYR4TR2N5EDMQQ3VH5JDT18FL8A0QGOPBRLK746OSQD61XIN37VX3Y6IQCJKH2WPQNBZ4JNDYUL3N2DNQMWJKRMCK2TVLM7QTOFEMJIKJIY8D2VOYVTV5D4Z1YE1PRSCNVAYMZ073CZ2SDZI75XPTCKGJFCN5HUSQMLHRW1YVMRTD26OYVTJU2IBAUF7NC2MH7B6SIRB4YU7KQ2H9OP9NBYN396XGTBIJ4C6Q0VG3IFV8BQJRYYZNSZ69O3IBUUANCNFEWQ8S864V3FRJM5IVBUR56X2WD59N47WOA5V7P6EMUA68BZOOBFBHWA8ZNCF3WGRVJ38H9A65F4AWQTLDHKCPVES0XWKDRBQEIAP8R6F0861RZC8TR1LB42Z4A7KDQTD3EWDG4CMA5BGOC00LNQLQQE9GALXJM1AFTYC3YSPEEA6TLBR97YPZ7MD0MX5JE3O311VEOXMV17CF8GUZTNCNCA77KCG1M60AM2SJGDL9CTY0AYS626PQQ0RQUNTCGL9U71S6OBJF22BIB7XMKAZGG9KMA1PSJ9TQK4T85LHRMAOOO9FNQ7S5MTEXH6VNLRWT9LY7DOGYT7T6LVX1M21CGN4RPVRYQU5VDUF3A792QTCEZ8CL9U0IPKCLG6IIXH8Y1XSQGUQETZLMAPRHI5PWTM5TITM4PQ48LDD2FM5F3LPQYPARF0ZRRC5ERY7M7MP2UD1WCO1WZAS7XFVSJVOORDG98YAHEJ7HWNWLOEEQZ3SGJXHC2F2BX0BGWROEEKHF3BBAIA35GYPNKZPBGYEZGVJVBFOXP0CELCD8M7USBXVZBNWW1CXF6HY7SFY2L6FGLA18MHO94LNJ0JKOJRVD2W84D6G68R65IFE0LOAKOOBKUF78VAJUA2DO2XUF1I0CFI0L5J2VGBOELO9XY8AY8CVG2PYNTUI5NY5CEM2B7NDYDY2DNWHT7242MKJGLE1MSJRNJXJC5YQKZW23MKZWDPYLU2PU3MQSLQ5U6FUQD4N8BJ2PHFT0E583K6TG8O9I8YZ8R8W6Q9J81PAA0ZCNTQDGI290MEHOV50DKUY9IMA5MZ1VWIF9CLPHKIQPZWKBSUCWOWQ51356G8UI1D44Y7CAGIT148AM2YCRN46ZSA89FJ1BO7OLRGDKH1G63O1SSI3HW2VW75BOZ3VWGHDWKOUMLSALO0V38GGWFKELCREM4OKE6JPMA573OGV4SA86A8GJMYGW3SJTA8IX7VE4B9S28C8ZOAT2J7BV71S82TJILESFYYXWV4V1FDA9PH7SZH93WMP5351IQAGUJS0PDW6FBAGUQIJLLQI44PIB9RTQ2DB4XGQWGIF3AURM6UFKMGWZRCQUAPFM2GCYZBWASM42BFT9XW5EC83MGBDKPVMR2T0UITMUY5S0CUNCJGWDK0ATDQHNYCKWZCZIEZR4AAG6G3AMN119Y972J7HRBYVLKV0ZU5XKPS39J3D9GVZXBBYQ5XZ7HZSBEVMK2ARI3GK56XIFU7BGZYA9XAUX6P2P0RUOGS653HTUQSK7EJDAOCCGLCNSGUCDEU4E3UZ206CH4FI4QNIMCS1OFE344DP84FGWN54KKB9HZUB5TJ2SCP1LTGYORVXMG4COYMGKJX21IJPL2XALBWVFEU276FTPDM0UHN772I9ENZ39RCLUKCBK8X94J9D34DOVIU4FP2ISNGRFRTGTUZ40AGMJD3OT45AAA7RW854IUIWR5UCQSJ958NK18K2MEOOH6H5J1JLPVM6SKUDJQX0KW41NMPON2H36UEKOOTO9YKAMHSHD6JWGN3L1GHXBVXMDI0X59PUX8RMCUE5T8AHJKMIQTJ77VCD1XW4HVC4HPZ7VH871C33LG3SVH6BQHN1WEKEXAOYW50ULEN9KB5UR9RLU480O0EZ1XBGWU9RN57GF87GTXQECS9NNZJT1O9WR0SO36DQ1D6M1B5LXR6R9ZM9NOTWAGQZVBOFGIDMJ0CYLNLCUXW9HIMREJ0EDGFLN6QQMQ5EEK78MON03H1DJGIDOX1XIY83LRAEWUQ4SIUXAD5PVZBWE116OD2PP7VFB4NVD838RXL1LL2ASB1JNCOJP4QJS0FKNFM6Q9BNW25HG0K3ARWD6CSYG359IKGQH1E6ZWKI0EMK762PJN9042EAMNPM315BLFZFLD3D7EDRP8R90GQUBFMFM3KB6XEY9BYR7N35JVTPOMLDVGMMBA06TJSHSR79ZEHE9Z2DCKAFLWQ0I6GQBRNZASYNULDROKQA574WE",
            "requestComment": "trepicandor habitatio regit, Multum gravis novum pars pladior egreddior Tam habitatio Quad Pro esset",
            "requestStatus": "P",
            "userId": 1,
            "fId": 0
        },
        {
            "requestId": 277,
            "requestSubject": "Prepaid Customer",
            "amountToPay": 224.53959271057491,
            "requestDate": "2022-05-25T00:00:00",
            "requestProofDocument": "9CVABBT2NBLEQ7FUM50032NWYVANF722EJOJHNZW7W8MTF8DEVTZH6H6OYCF15NG9I06IWCY53S7U12JMW8JD2L71IUIBJU19SDBE1VIIUTDDACNVST5W326XS502UNM8RY1OR4K0Q0I87UR56NIQP45Q6EMWVGO774MBBZ3N8463JXPXDUV64VJMTAHDHO49BB028FU7JUHKX279OPI1LI2BLZI0HQ6KZWR7WMOXZNN9EZOR38PS53OT8PH9XUQTOXK1AZC10K1XVSXLARW91DEW8YY74F05XTKGENG3WNSK2QYGRWY5YGRBJOSC14XKKW018H6MASDELTTH0IG8GU6G29XQV42RP706QW79PCV53DPPUACIOO4PPJZYJGR6PLOESNR3A6J4Z1DOJ7WKSJ303BG6X8P8KOFHPBW6J87H5ZPO6AFBJ7E5INBH6L51GAJALVZ8BP0JCLV3LS0MTDPDAAZ10FZY260VFF2AB70U6VTWS7VEKJ82L60BWY7WQ2G5KZO6QPBMDU7FG28SJLDJYYA9FREDZ433EOBSJPOV8LPQYKUUPEC4PW7MPEQYBXN8Q30SQF9TXIBC8JBUWKNKSZEIGP35YPKAYGZUK2395J77KUD53W1R92GRPIB1C4U7X1ESKGATGEE8R7XLBX12NT0V0751Q2X1O09JGLLMM7AVO70ILQPF2SJ41JRDB83EHDKRYD5QCFFFI46S6MG0CHYVG4IWT7BE4WEAN9K7KZ2NC4MWCZ6OR21ZFOBTV9X431AMQW5X28GDFAJCHLJU1MM2UEUYYQBB2YJBT06GT8MJMNK45YBAP22HF8RB16ZCX4BGR7IHF30S03F7UQTZE1MZV1WK8UEM9AMHB3DXGTUL2AHCSKGBDZXVICLPBY9KPDIQHYVQCVJK60WLKJRND289CQZZIOMHKAWORRVUPQZIGCOHF04R6L6M48DQYW8O910W47TTOXYN3QTZ2HJIJUBZ39KID4WTHA9FCRD86B38MJIEFDOGDP4FP1TUNAFJ155SHDNA4AB7Q2CJQ520GFGS6UPBXIKVWJ7GDQX2QDB2DWONO94H7E3LPDMMOCCMQGB7UV6080933EE962MOD2OHFLR03AEE0OBXLGST33975ZIBYCGLPO9NRTR945XYMV2E2HOP9SK9TGCF3F1QTSOBFN5ROJPX6AK9W39HORBX3ZUAHB5O464U7RZEBW1Q3N3IW3I06K12GQ7GTUACD0T06Q153U6SPLUGWCEDS5IK42DGJILGLOC2U2C61DWCD9CVWRKHGWJ8I8V3CLML8P618RLTZ8CF866VPIJSY40P43JL78TGRB3N2BM45RH8J40C2ZEU1UM3PHX480LREWOX2ITEVFM7NR5037J7UZEXPZXKEIW55PTNG29J6ZZM7EGXCX11GEXFHR83K90DIH2XYHJ0X01U0SPAI07HHVOQSE5OU6YXZM3QCIZUD03GD2FP1XKK1JWMSB4KCV5Q23VEOZXZ0C4GR8DPYGNWLDVGPGX1DFIIUDE971020KJOFFVKXFLV785O8FO71WMLULLET4IXGKW1T70ALC3YTMAL8P1",
            "requestComment": "quis quad in estis quad et e esset homo, Longam, Quad plorum Et vantis. quad nomen in nomen gravis Id et",
            "requestStatus": "P",
            "userId": 1,
            "fId": 0
        },
        {
            "requestId": 139,
            "requestSubject": "AccessorySales",
            "amountToPay": 756.1903968947895,
            "requestDate": "2022-08-10T00:00:00",
            "requestProofDocument": "TTI7ZOXCFKTH1O0KO4W0VN4ZELCXZ1EFV3B1RUUUDIH1ER9MIX4KLA95OITEB0CD6DMYDYTU91MD62LMBPE2XUULT5C81GIC53V05B9K3ABJNWZMX72MMAGBJ047LLTSI9726KG0FUYMIAXW6QATEWQVNKG462YIHI1DPWFDQ26RCTS9371VAZEMJCEM3BTDVF5Z9J79BX3BQYITR71Y037H4EUDIS9E9SWWOS0J0RJDW3WKTKVWAUCS8OVUPURINO2X2M5Y7IY9JUL1IAJXXD4EG3O0X5T501Q80YH7FXOSW39E2UBFAUK9JOHZX501OS9H3D0JSCI0OCHCUAX3UEV5HGOCHI99WN34URAPTRMYCKK7645N8X6AX30NON2A38418DI2Z792RWTWVH6CDL1YGT6QRM06OCU3FJYTM2O0O4I0A3S7HQXI75KF6SBD62DE2PHBICQAX09CA6GNUTPYFCW9YJNTRATLQ4YKMGO4ZMK6W84ZCNJDDFZPT7DZPWJM6OL67V1D4KZSRPDPENH3RG8B48QF3PE33Y08MYRGM58SF7X4TNK2EGUQFA1Y4LAF6VOTO53GV1GM7FVXBMLF4CON4ASBWSB1UTMJI4FNK37DZ8I0F4NIZUAT71OEDRK2PFRESBF67YV15BNVSRWS5T10JSCGF0ASI4NKG373OGB1Z8OWETMLUSWWDRV0YZR6O2I0N2FOKS3OI00A4G1MEOYQ8R6P774PP4DWQO9CDX11O8DDQLVIX4S04SSVVPGCOEYDM4KG6P8GMW1ZDTZMBLSLCCRXWDGOHPDA90QL1FC7WBD8QSI2PU02MD1ADMJT8KZXIRPD2DLW9KO0ZI73UEYMOBOWYG8EVIYCCGPZ35ZB94S1O1AUFGYULC972TEL560RLCNIT80PEMDJIM7X5EZFK4QZ7IW9QD6241GCDS17G8FYZQOGLHGR6K6GLNBBBQZ1GAEH5VJDDSYBOS0HTGN9XEVJUZQPGPVP9EIOB7AQX2EEMVSTMUHV2P41EVM65TWNX81A9C5L5XBU0HXY7W3L8ZNJAG9GK4L35RHDUHKAPWQ4E91XXNY9QBEXLH0T3P01C7O80K4QCTWC9I50EBIX5CDUCJRCGQ6ZVOS6KTWCJ8WXE2N2CZER63V0UUWGSS9LMXGKPZGLF5EXFFG9WO0HCFTRTSBQWFKQZBAHM2CCJSC0PXLEDMJ3SS873PRXNPPZLNY35ZNUCNXK3T2V7XCAVGY723DWAFPU3CE2ZH9EZPR4UO4AMVQQCE35OR01LQJWX2GQEZVPNYB6OTCEZ3AEOYHO88D8H8S85V7R7DVMZ03D3XHUEM1IG47YLSH6MN8F620TMK6M8NENV4KBRJUU6AS1N86FVO0CSO61WO7TGF9TPJ3G75F3TD8W9Z6EDQQJM2V7XIE2B0ER0ZB35P7P9XJFFARXITGPOP6NOVJPQCRSYGWAN29OJ0AOIFRNRHKHKP2ASNE96IYW5QGYDGAFKR5OEI583WY9RA89ELIZOZH11DIRYT9A74XSJEW9I56AKP5VH7KSYARLA4M10DAAMN2MCGP0P8GIS7GC8M9Q8GBWDCHERU95VWNWMIJ0IK3PT8S2NASD3J16C590YA8UZBNWJKPQ398ODM34KERH1W2BUHKH8I17B9QILVI3K29UBDTP24GJJQS39B2207HK70C4WKJOWNXZM70GOUE42HOLGN9ASG3CKONA0OTILRNVTTG1ALE5TDIPBRN9A8VFKKEXKQGZ1WIATSRN68Z72XJ76YY91K7CV8B9EJGK5E4WU7VJZ0228OCM07RMR6YGP5FLHI8NRF1NTNCY3FA0H436VO86RUTZGN7PS92GRFBTNPTDVSJBWXZL18PSA2VWL275FN6TDT81SAJ6VUAZBH2JOMNJJA6PKF7LHNX8MPY3OXSRPJWGRWK4ZOHTZN92NJHD2XO8W1DMIZURTVT0EPXOU3MT548YFWF4GFPSUNKPJYMZTQ04U9OXMSIYAU2STE6MKPAE505Q575WHN0F34467IINWQHZKRW4RZF3FLYT3YRENLHNUMOOAZE17NHFJ65DA04H7W0I5A39Q30A8T4X37USLDWS3JAXSD4MG0FYM6IZV5B4N66P17A26CWU07EM06GCZDU7D6BWPVWF2R5WCKVK31G44LYERWYPOY49CYBUWDDBFGS82HAFAW9YXP3S8W5SW7Q3NVJD91NPN5PNTPCAMIESO6CNVJM08KE8QOL7XW698KASZFZIKU6ESXEGIWIPEMG2QHX444CPB5J4VKNFJ4GDD0FS94P1EGUL371IIUDFIH2MD9KX826963PQ14U0FABUAY1OJ5XOR1VWXTF0JRTCALFZIAHE0C0857CF7WE34HI48SS8OUGOGZKPI158NJOE1MQPGZSNCQ7T2ARQH8P5WBR6NMX5R6FLS43L12RP2SBQSRN7AFQEUJHPVK2U2MW5BL0Y76OEH023Z0EWZPVCF0R9MEPH0XMGW5F6RP03QBXTGEPU56VCQKQAUQBSG6EKDM6TL85APRL43XT7PVCT19QCF4B0D7NJXCGU7V8X1LNYYL7XX33LUKI4WUEGW4WH417QHY0TMFSGMRDUXE3942PCUBYCHS0XO6UXEHFY39YFR1I4HJII1MC2BUV50NCUEVSFXFFGY46V3AKTTTVX9IW1TRLJLAYFX40W827142JWGHZ1A2B6SEKWZRM5UVVO5QYY9OKRMTS6YZKBSJ9JYSNIJ4WHF1797UQQJ0SLIKJZLEX06ACALCQD2FF4R2BKLJZ38TSSRO0D8NW57WB5OWNV4DN3LNUF8YD1ETRCIKJXBC5EI9XUR6WPW4ZV6O74TL49AURD5YM4DQKR79KBPZO22O5ATV6TDF3P7V4OIJPSJRB5J7NW4VEUW26LPGKASTRYMUKC4WS6AWIBDZQM79PH09T5PJZ1ZFZQ0DIPNBS738J0KV8PQX2J4AXD1ENLXQ6VWSBZH0YWGHESPSLTAAB1CGLQF5O8O7AC1N3RK88PY62MW5N8TTANF4IG6KKBCQ7971Q2PT912M36DZTAHFFUWMXX4MLZOWC8YSFUELJ0J8LS1C27RAUXBCDK4TX27AD5AU7LKZVVWEAN14VSJE8E1EXLFUPLOGS9VFI65HNREZ1W1PIZX4IT2Z4VXL5P996FL1RMMON2RGZ2D1KPBPNJXZ7WBM9JCXH4SLA0XWD8HG2LZ1HV1FEJMMHMUVBZF3QTYUARQJRFCE2HWLW94DHWJXI53N62LDTDQ8M5RP5HNY77K0P8Y1U1MTA1B4N2DPUYLOROYQIF8Z8KQBK3YX3JISRWXLTM124Y48MW9198JFSMLQA0JK4GLAGTWUQDXVD6V9FHOOUWNV03Z5A7AT3HXOCUSTZEAWAO",
            "requestComment": "pladior in quorum et et quis imaginator quo pladior volcans quorum novum et egreddior quo cognitio, plurissimum",
            "requestStatus": "P",
            "userId": 4,
            "fId": 0
        },
        {
            "requestId": 213,
            "requestSubject": "AccessorySales",
            "amountToPay": 386.87107576377275,
            "requestDate": "2022-07-08T00:00:00",
            "requestProofDocument": "05B5JZOUHE47LH29QQRAYZ6TUDBQ8MXUDRB3L8V5RI7HHZSGO5AKR9O1YIB6NYMVGATT6YOIUMIGRPCVKV22CD243943XPITVC065Z9PHRQ5Q8A95GMRVKJ38PPWTKK54OKEP5PLLDKKNWDVZVXH3QXATXYG9CVW7K11NVJZQ05IZZGBBUXYM22DQ9LS79C9IOC2UC84BXR2KFBUGM4EFW94INAD9RSGOWZBMDHZMTMPB0TBYRBK4XTLE8J71UUK4ADNGZ8255SMAKSIUZEHG8CR2EWDU9XRY2K1M5UYJ8EY47ATG1D2FC3WXLK22U8V81O80RVO4FY7TDMV33XSWVBLYN30KSVOZIQ3J2SO5OXZEV2KZPYZXGZCP29DNV3BK98AMIC0A8M7YB73KI1VTWRJJEEGSF1ALLF4NRYGCYPOTREEV6S4T7HNIOR84V7U7CMCV2FTKKIV62QS0ZKMNWGD3SMY0PCGQVHH51ISQZK9PMHFYZ74BL6BV883GGSU815BL9NYHSVOC6OHA601I755O5LWSFC96P1NH5TPC9NJPIZOKRSAGRC1WZNFNQ51FMHN5105CBP8JMF66WC1M1TFC0RHHE1L3M330CJIQMX524I9KH9QE4FDT2A5AJNY935WJC5UDTAZ4NC8IHX04B6Y6PAX1D87ZZVYYLP7BECLTF95Q2NSMNTYX6QU28T0K305RE9XRPOQYL5RF47YQFLB5X1RUV53LC0QF4DBSQ0WY30B1ZEX1U95IPZUCH2VKL4LLFBBRV50FOC2XPQVH71Q3V7Q5IYBO4CCYEQMN255P9PUCXWNQ6EDKEHQ7L68WUCACZ3IZ48E1V1T5DD7MBKHQZSKW0F1WX9UXFHCUENMXZBOCOKT8YMKAUKD6JLYP7I4M6WPW1D7OXJQN478FLTYAOK2V45ASOXQH616RUX6LFWCATP1BCJ3EKUXMTURV2FZ0T9H31HKOMCVS7S2F3YF5TCXB3JX05BIZWBGJ7YAVYER7Z5E1SCR3ZU6HC5ZHJKJAUVVWBI75OK6EKQCY5W7TJE024Z72YTBDVGC39IPA4MFFNRWLS1BNCPRFVTRBB56U8TJ3D8PN7XOXZKFC3L9XHO05PW8FRDYZFL7U8S7JCOGF0UGAEE8PW9CJSDDH09VTYPHDDL4ADPLS8L4VFY1D59268N2UEQJ2SNGBD2WT9XB7NJA69I118INPNA5QJ9VN5IZL4TIC2838XVIOCVLWOHUAZRO2X5AZ1O14JP1F0OZZFESRSHDNOZYNOPLD5FFWY368UD4NT6V0IUULYWAFSMB2QDGU3O9K921C8KXECQTH3Y4UV0E85Z4BR3HGXAJ5WBQFSICEZV22SUZS8LY390F9YQK42GH27OLS7O1DN099W1IX4O7BBFWVVHH2X8CIE0U486LKKLF8R5CW7NZE95QRRPWQ7YFFOQUW6EOX3NRQ0N4P4KV98Y9993DJ9VCL50K0BFPTZ1ALE0R3L6LN367PHLN305O7B6KZ23EOU2A6",
            "requestComment": "glavans quad vobis pars nomen trepicandor egreddior si eudis non non funem. parte quad homo, dolorum",
            "requestStatus": "P",
            "userId": 4,
            "fId": 0
        },
        {
            "requestId": 249,
            "requestSubject": "Sales",
            "amountToPay": 403.98817251156464,
            "requestDate": "2022-07-24T00:00:00",
            "requestProofDocument": "KC62RXA82E5V8KBZY1M0CQZCMAZJBTU9KNZPGTXKG9OMSJ5QNOD0T5BTDUFGYRW9JVBLLMJ531J21DK258VMGUGEC5CLDGMPDF2W8K5157WRL8S0ACBQV9SPFX9G9YSNFUPMANUL3UH8YOS3DCA04WT3MCGAAOR6F8CRI5PNHQM1SKRR453XORIJ0MZX6JAE2BTPB0L7NNIE9RB2LP65LTIOQSRW5RGYG7YHR1F4KVA084A8AXCHD5S9S5ZJ9O1V6KY1SUBJ92KQJHFLIIL8FYKAFPOL2VUVTEUN68FGMS7BK2PAPD1Q2TG7ZNM25PHD7PW4NSF925LNR9QC0DWPU3SZYMNJMCAXAU3U5KNXXSNX8TGQW92SSRJ3WX614WMQUOCX6V6FQZR1GVR45XMCAI4JAZY8ELT16X3JGJJ02N1T0HN161W699GBKTM6XY146PVIR7OLDL9MHBITCX1CPMSWHSZNXD34MXNAL59YDATNZTU8ATUZWOEJXZ0Z70O0H50JO876N3ZFT4XOXQC4J47YI3DM49QCMT5TTAK2LNBTPZQT1C1HNKGDY20LVK1ECMS0Y3UN5AIVSD8JCJKS79P2CSVR9Z71LXH26QUYHEBC1LLLTH8BZ962WQN683D63G9UW5CLOMATYC0Q69XSRV1BRE6G2OQE059KBRPN5NMDZC4KPWZY5LF7FX3HZVI0VWTT3FFFKAN39OCEALR6OR8FP15DN7N94MH3JBH9HKEVYBYRLP7D4CB3OE31A1RCMDZN69UZ4HO4DCGE3ESY095SADF57FZFS19KCBKCU89MN7QBXPYV9TCC86DSUPROH9BC3V2STG3S0I52N38IH36ZOWC5YSH5GL4EWD81N61TPKCP1A4QH96D3BN7IWT1YYBEDR6AV6VB2CA4JN4NNQO7EQAKP1IQCZUQ9XBA4UVADVBQ1JNVS6E7A30MGLKUN4Z2IJVMBTJTVDUJFKJ6DNY5LNG5XPUJ91N9V97IN0JYNLCX9G7V2EG06THV3PPMZZJTQLN6C0ID3ZI0AJWGHYGVLM32RCFXBXZN1I6OT1J1V3W6BGKKT850JO83ILEZLK160UYSC7NFFF0IQWRASU43RY4D9267NJGA1P5GIR7LLPL3NQCLU37QGXE1QLJ91FSWZPG0RAS0NIH2D0PJQLDKBPU3A3PW8YK5WO4YABTJA63XGCOPW0JG28K9VCPNLWSPYC5OVR8ERT95MWNYFZ08E43O4V2XM6YEDEZ46ZT4R5O9YFNZOR7LVKAU8HK0OBRLUVR7WJSG5VG9FTPO729UYDIT35VOFTGGD3E2OF35YRF031EERVSL2XNHDY4QO31CF0VBFN0SZ3W6YIP2QGXJ0UD",
            "requestComment": "linguens trepicandor delerium. e funem. Versus quantare vobis quo, linguens pars nomen quo et non fecit, quad regit,",
            "requestStatus": "P",
            "userId": 4,
            "fId": 0
        },
        {
            "requestId": 367,
            "requestSubject": "Cutomer",
            "amountToPay": 849.81199647291191,
            "requestDate": "2022-09-08T00:00:00",
            "requestProofDocument": "PS0MPJYWVZRJVT3G8NO6UA9X1SSFZZ2TTM1N8X2SGUVBA1XYHW8G8D8FJ2KXQIWVXYP9SF7AKVQ0EXN0UTX3QMKGDM45C51XYZDCBO61OXVDN80LFJ2XKT5BD9V5B2XFUS1EJBP6NVETQ7T4LJQT24D5U2Y1S0QMZFIU7L14UWAOEBK6GRJRB4CPFWJHCODM5STBOYX0ILZ6TOQJIRK1GZAU2TEA2KR5INJMH8IHUJ9Q56VR50YL3C56HY8UKMXYTTO64419827XPKPWXN41L625ID4J0NX7LBWCIPM1ZPC058GW9CXXIVDNQINR0I9L5ZBEOCE7032VU10AX79NQZPPY8LZ2V0HFRU5W28WYQWETHTPHDUS8LV5ALGFRE552LF36UDUZDP02AWGFWIO078UVPUBLS4JKRB81QIM0ZTVWV20OZ0VWG4VCL7H019685FBYOFPDVO1DDX0MUNMS9N3NGVFI0MYQNMQFR10JAH0R2HZO6V5ENEYIBNHT06C9QBQQ6KUSM2HRMCLZVQB5GK29O844J7J45R1QQ8HL0DRKX7VZ2IX9U6S68H2YGQ8FICMVAU8N9Q53SIBGC4119A9YZVI96J5A4B2KL0O8AAZ41PDQ5LLBO7583NVEBYGQKVYGGRVCGTRZA4WAHR4KXTLX5TGX4AWBT9J6QXADQ9VUG6XZQLWJUVSR91AMBX76XF51KQJKHQUOXRHZWH7IDCHYGSXPMN2T1PX00WE01B2314TIJBPTQPSKX7KSTUYTO1N8TGZ026G1AEWCYF5BY82CWC3SBM77D8E0GLO3BPRJ8RAJB8TDPNVFYBBHD6PFZ9N2ZWVDR1Z8HJ452JH3TTIQCY1596Q50BKY38JECFMNOMYF76FTPLM5RXP0UQ4KBU85Y51TZ2QE6U1P0MY2RXFEPE75IJKMB2CTETG25LTNV7YWVZ08S1SEEUFJXVBGI434I8B65WX63RJHFB9IICT99YEKEW4A9C5Q4UENOT2W4MAMAX3MLSX6ATUJTRS8RNWQMSDLWMTO9X5NOR9GSHOGFZFB0UUX1T4HQJ0IKIPZZ9WDO6V1HBG9YFBND1L1RWNGSOX4RRVASPH621NTZTFPDUIA8D4IXN72LGKZ9R9QG5H8X5KBER2YGX2Y5MVEMDC4HFKMHNJ8JP97C9D2ST35L9LODMUNVV33TDQILXUR8UEQOVLV9SLT96I8TV9USWCOM6EZIUHVZCXQVV0H1YD29AUMUIOPNZYBIP3HHLDEBQTW9SCXVSSUI9ECCR406S7ZDL85RI0FLZRJGXD25QTV64T8AR5PHD8IITJNJ76DRD9JHVWEE1UFYCT9S0V0CBY8Q80MEQJYKF3TUAQFVQBFITK609VJC61GF1S9U90OIVUJ8ZEI9F4L0IPXOUL4V0MEENETHHKLPMXMY0Y1VC9W1FGXBUK0NWTH9G4LKL0SUJVDK2YNVK9IQQCZ6HHMXKYTTFDIWDG9CH1IJ3C9WW42NBRJ35E34DUAK2J4PGRI4Z59OUF347Q0FV5IOUFRZC5ZMQXGJ7KF5MYO5IU8PAYWMUVOX1GV10JRT6MXXZKWNAVTXHC5Z61OD9CSV8IHRPE536UZWWBQP28BY2RGOAVVYUDKUT2OG25YWQPQMD93UAZB10TTH2THTJ69SA42UNAMX9F8C0TA0S0OU2ITZ86D9N5DKGYC8787ZCERLLHH8IG1JHEQRB2LGXD942NW2H1TJSOIOQ8ERP4Q73T217KX5NQ2Y4NIXLERHNHQTW102OTRSN208LUUW4OV2MJJ3PG6BC8JL3855JUGTZ9B2MACQJVDZLO7CIXD8MGFEIE5COOC9722C7GGF3FRHVKZF1TNMH86JTXK7502VI3SJLU52HX47PYIXFPAV1QSYVIIAV8A3DVYSSFT6OL4J3ZUVEMSFP7TSBTO2CU69N1UTZQ5ZW47GL8VVONV9FUE526GZRQUTFVV251VOHTJL0D63XTEOZXTTNORTA6759D1QCSPNS7RMBS4OZD1YC6UH12FHA2EBLEBNCFQ53RWR57HUJ2TX49S3JJPAD8CPTG0XHHCJMWUL92CTKLX78G6BL83SQFSVE6YO7KD2QAA8F7TG7VPRB5HCAOB8DJT64Z633NMZ8VGY6YWDENLUQ0K8OMEI84O7G34F0QCJ9PJFOJ5CRYTQXYG3EXEH83R369H2TGDOA2L0H4K5G2QAAX9IM012CVB5YF9E12IAL5FVDGMAD805CGT90ZFTFACFQF11V53EKGP5IE46DQP3U5SHMZE2MOUATZ4XFLF74MLWRNQMU9GPK8KLMJFVR1RVLECI97QSBHY8KWQY9S8C85QKFJAV5JG3UPBDB8CNJNE39C1QTHMZSENFOR3QWVMR1VDVLDM1FLTKRMA2IK2OXHAG1VOK4MQO0M1EY55GUKJ7K2O1G08BSYTJKXTPO2WTU5J4LV4CFLUDX2VZ6N33EFV2THU1CFRRNQDEJJGLWWW74GMH1UJ1ZSEEAHB313Z0U2P6OGFM6H7IJNYDVCZIWQRVBY428DJTWVD2RFSKEWUHLWVMIY7O3G43AUVQCDETYELNAWLGKE4ZVA9E3HJA5VPFR9RXK270I1J7B8BMCR4OC470KGMVU3N2O5V14OWH73HUQ23V5WYER03N1RC3GC5EDHI5CAINUMH9MD9ICRQY49BO270DCS1VX2H9JXIUEBJ4JT1OHTQPL7A35U25A4A2LMBJV0ZE8VJTP7585BVJ1C9PSD3PVDK90HJWIISHUBGQOGEYPUZY9R08CLQHWAJUAAS8N8QNJEOQVJ1BZ5Z0EL09HAKXRAKKRMFDO6AH3BFU2ACTJEIQAJFOAJRDNTV8U4Y93ONSVIX36566XQDDST986Q35FXTAF70XC3QVQPVRLCI4CKFXFIG0VP3CKIDXPMNZ59UU0HM2XIMT8ZSUHVUXRZ2MZDB8BY2ZPJY3PLXYVD2D2A4KPIGTRP8567UM6DQZFN3P0P4WYW1DWPKP9QITH880ASWIQASIM3XF7EK0DKUUNU9GN5CFVXH6E2E8SM5O4JRTS4HV6IFXEDCGJGUKXCNOLQ04ZB7RF6P32FOJNH9CIKS0QXOCSKQSW2823DVUANI8O8D4RBXF2A60X0E2NVYUFX707MFAME1U2KCHKKKGNBPMV743ZT7FONSQ1DX5VMSN9BYCNXI3AI737L4ZHCBT7L5ESLF7NFL0I2CK8SF2B456GOJG8XOJBZFN5KK2HAFUW6L58KRPX9I3GZX32ZYQR1PIMPEN7CK0OAA93E8N5YM2HC76NH0ICP3UH2JI54HKOIF5PN0ORBKSFN19I80QC1OY7FS0UPH1G1DYX1HZHCR05AEU19ZX3R8NUGYAVZT1UJBE92CGR080ANTW0YZLPJXOTQ4G374HIP6LZ0KYWJ62J7C6N19W07CAMMLJYWDJWRHKH7XZE0O6DU5LDYT1X7GBDWZCF0005M6RQRPF49IZI5XRGZ5Z3CMOA57L8KKD0O0QOEUM8DWNPHS7Y7VFV0WT0HGKK46KP5ZT46325JRPFYZTD0M1O5H0R7Q6XA24",
            "requestComment": "et non homo, funem. quartu quo Pro Longam, quo vobis fecit. Id novum manifestum et fecundio, gravum quantare Versus",
            "requestStatus": "P",
            "userId": 4,
            "fId": 0
        }
    ]
      let arr = data.map((item) => {
        return (
          <Request key={item.requestId} getPending={getPending} data={item} id={item.requestId} Notofication={Notification} View={View} subject={item.requestSubject} amountToPay={item.amountToPay} date={item.requestDate} requestComment={item.requestComment} />
        )
      })
      setPendings(arr)
    } catch (error) {
      console.log(error)
    }
  }

  const Notification = (id) => {
    Alert.alert(
      "Notification",
      "Are you sure you want to send a notification to the user?",
      [
        {
          text: "Cancel",
          onPress: () => console.log("Cancel Pressed"),
          style: "cancel"
        },
        { text: "OK", onPress: () => console.log("OK Pressed") }
      ],
      { cancelable: false }
    );
  }


  

  return (
    <ScrollView contentContainerStyle={styles.pending}>
      {Pendings}
      {userContext.userType=="Caregiver"?<View style={styles.addBtnView}><AddBtn onPress={() => setModal1Visible(true)}/></View>: null}
      <Modal animationType='slide' transparent={true} visible={modal1Visible}>
        <NewPayment cancel={() => setModal1Visible(false)} />
      </Modal>
    </ScrollView>
  );
}

function Request(props) {
  const [expanded, setExpanded] = React.useState(true);
  const animationController = useRef(new Animated.Value(0)).current;
  const [modal1Visible, setModal1Visible] = useState(false);
  const toggle = () => {
    const config = {
      toValue: expanded ? 0 : 1,
      duration: 2000,
      useNativeDriver: true,
    }
    Animated.timing(animationController, config).start();
    setExpanded(!expanded);
  };

  const saveStatus = async (id) => {
    return console.log(id)
    try {
      const response = await fetch('https://proj.ruppin.ac.il/cgroup94/test1/api/Payments/UpdateStatus/', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(id)
      });
      const data = await response.json();
      console.log(data)
    } catch (error) {
      console.log(error)
    }
  }

  return (
    <List.Accordion style={!expanded ? styles.request : styles.requestunFocused}
      theme={{ colors: { background: 'white' } }}
      right={() => <View style={styles.requesRight}><Text style={styles.requestHeaderText}>{props.subject}</Text>
        <TouchableOpacity>
          <View>
            <Feather
              name="bell"
              size={18}
              color={'#000000'}
            />
          </View>
        </TouchableOpacity>
      </View>}
      left={() => <View >
        <Text style={styles.requestHeaderText}>{props.date.substring(0, 10)}</Text>
      </View>}
      expanded={!expanded}
      onPress={toggle}
    >
      <View style={!expanded ? styles.Focused : styles.unFocused}>
        <View>
          <List.Item title={() => <Text style={styles.itemsText}>Date: {props.date.substring(0, 10)} </Text>} />
          <List.Item title={() => <Text style={styles.itemsText}>Amount: {props.amountToPay} </Text>} />
          <List.Item title={() => <Text style={styles.itemsText}>Comment: {props.requestComment} </Text>} />
          <List.Item title={() =><View>
          <View style={{ flexDirection: 'row', justifyContent: 'space-between' }}>
            <TouchableOpacity style={[styles.itemsText, styles.viewButton]} onPress={!expanded ? () =>{setModal1Visible(true)}:null}>
              <Text style={styles.viewbuttonText}>View Document</Text>
            </TouchableOpacity>
            <Modal animationType='slide' transparent={true} visible={modal1Visible}>
              <EditPaymentScreen cancel={() => {setModal1Visible(false);props.getPending()}} data={props.data} />
            </Modal>
            <TouchableOpacity style={[styles.itemsText, styles.editButton]} onPress={!expanded ? () =>{setModal1Visible(true)} : null}>
              <Text style={styles.editbuttonText}>Edit</Text>
            </TouchableOpacity>
            </View>
            <View>
            <TouchableOpacity style={[styles.itemsText, styles.SaveButton]} onPress={!expanded ? () =>{saveStatus(props.data.requestId)} : null}>
              <Text style={styles.editbuttonText}>Update Status to finished</Text>
            </TouchableOpacity>
          </View>
          </View>} />
        </View>
      </View>
    </List.Accordion>
  )
}



const styles = StyleSheet.create({

  pending: {
    alignItems: 'center',
    backgroundColor: 'white',
    paddingTop: 10,
    flexGrow: 1,
  },
  requestunFocused: {
    justifyContent: 'center',
    width: Dimensions.get('screen').width * 0.9,
    height: Dimensions.get('screen').height * 0.073,
    borderRadius: 16,
    borderWidth: 1,
    borderColor: '#E6EBF2',
    marginBottom: 10,
    backgroundColor: 'white',
    elevation: 5,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.8,
    shadowRadius: 2,
    paddingLeft: 12,

  },
  request: {
    justifyContent: 'center',
    paddingLeft: 12,
    width: Dimensions.get('screen').width * 0.9,
    height: Dimensions.get('screen').height * 0.073,
    justifyContent: 'center',
    borderLeftColor: '#7DA9FF',
    borderLeftWidth: 1,
    borderTopLeftRadius: 16,
    borderTopColor: '#7DA9FF',
    borderTopWidth: 1,
    borderRightColor: '#7DA9FF',
    borderRightWidth: 1,
    borderTopRightRadius: 16,
    borderBottomColor: '#9E9E9E',
    borderBottomWidth: 0.5,
    borderBottomMargin: 10,
  },
  requestHeaderText: {
    fontSize: 17,
    fontFamily: 'Urbanist-Bold'
  },
  requestHeaderIcon: {
    zIndex: 0,
    position: 'absolute',
    right: Dimensions.get('screen').width * 0,
    backgroundColor: 'orange',
  },
  requestHeader: {
    alignItems: 'center',
    justifyContent: 'space-between',
    backgroundColor: 'none',
    height: Dimensions.get('screen').height * 0.08,
    width: Dimensions.get('screen').width * 0.85,
    flexDirection: 'row',
    padding: 16,
  },
  requesRight: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    width: Dimensions.get('screen').width * 0.35,
  },

  Focused: {
    borderLeftColor: '#7DA9FF',
    borderLeftWidth: 1,
    borderBottomColor: '#7DA9FF',
    borderBottomWidth: 1,
    borderRightColor: '#7DA9FF',
    borderRightWidth: 1,
    borderBottomColor: '#7DA9FF',
    borderBottomEndRadius: 16,
    borderBottomStartRadius: 16,
    marginBottom: 10,
    padding: 16,
  },
  itemsText: {
    fontSize: 16,
    fontWeight: '600',
    marginLeft: Dimensions.get('screen').width * -0.16,
    marginRight: Dimensions.get('screen').width * 0.02,
    fontFamily: 'Urbanist-Regular',
  },
  viewButton: {
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: '#7DA9FF',
    height: 40,
    width: Dimensions.get('screen').width * 0.36,
    borderRadius: 16,
  },
  editButton: {
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: 'white',
    height: 40,
    width: Dimensions.get('screen').width * 0.36,
    borderRadius: 16,
    borderWidth: 1,
    borderColor: '#7DA9FF',
    marginLeft: 10,
  },
  SaveButton: {
    alignItems: 'center',
    justifyContent: 'center',    
    height: 40,
    width: Dimensions.get('screen').width * 0.765,
    borderRadius: 16,
    borderWidth: 1,
    borderColor: '#7DA9FF',
    marginTop: 10,    
  },
  viewbuttonText: {
    color: 'white',
    fontSize: 16,
    alignItems: 'center',
    justifyContent: 'center',
    fontFamily: 'Urbanist-Bold'
  },
  editbuttonText: {
    color: '#7DA9FF',
    fontSize: 16,
    alignItems: 'center',
    justifyContent: 'center',
    fontFamily: 'Urbanist-Bold'
  },
  addBtnView: {
    position: 'absolute',
    bottom: 20,
    right: 20,
  },
  addRequestText: {
    color: 'white',
    fontSize: 26,
    marginBottom: 2,
    fontFamily: 'Urbanist-SemiBold',

  },
})
